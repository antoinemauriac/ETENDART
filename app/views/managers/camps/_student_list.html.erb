<% students.each_with_index do |student, index| %>
  <% membership = student.memberships.find_by(start_year: start_year) %>
  <% name_style = membership&.status == false ? "color: red;font-weight: bold" : "" %>
  <% camp_enrollment = student.camp_enrollments.find_by(camp: camp) %>
  <% school_period_enrollment = student.school_period_enrollments.find_by(school_period: school_period) %>
  <% activities = student.student_activities_without_acc(camp) %>
  <div class="row card-row clickable-tr" data-clickable-table-target="clickable" data-url="<%= managers_student_path(student) %>">
    <div class="col flexy-row" style="<%= name_style %>"><%= student.last_name %></div>
    <div class="col flexy-row" style="<%= name_style %>"><%= student.first_name %></div>
    <% if academy.banished %>
      <div class="col flexy-row <%= camp_enrollment&.banished ? 'non-bg' : '' %>">
        <%= camp_enrollment&.banished ? "Oui" : "" %>
      </div>
    <% end %>
    <div class="col flexy-row <%= camp_enrollment&.image_consent ? '' : 'non-bg' %>">
      <%= camp_enrollment&.image_consent ? "" : "Non" %>
    </div>
    <% if school_period.paid %>
      <div class="col flexy-row <%= camp_enrollment&.has_paid ? '' : 'non-bg' %>">
        <%= camp_enrollment&.has_paid ? "Oui" : "Non" %>
      </div>
    <% end %>
    <% if school_period.tshirt %>
      <div class="col flexy-row <%= school_period_enrollment&.tshirt_delivered ? '' : 'non-bg' %>">
        <%= school_period_enrollment&.tshirt_delivered ? "Oui" : "Non" %>
      </div>
    <% end %>
    <div class="col flexy-row"><%= student.age %> ans</div>
    <div class="col flexy-row"><%= activities.first&.name %></div>
    <div class="col flexy-row"><%= "#{student.unattended_activity_rate(activities.first)}%" if activities.first.present? %></div>
    <div class="col flexy-row"><%= activities.second&.name %></div>
    <div class="col flexy-row"><%= "#{student.unattended_activity_rate(activities.second)}%" if activities.second.present? %></div>
    <div class="col flexy-row">
      <%= link_to managers_camp_enrollment_path(camp.camp_enrollments.find_by(student: student)), data: { turbo_frame: "top", turbo_method: :delete, turbo_confirm: "ÃŠtes-vous sÃ»r de vouloir supprimer cet Ã©lÃ¨ve de la semaine ?" } do %>
        <i class="fas fa-trash trash"></i>
      <% end %>
    </div>
  </div>
<% end %>
