<%= render "shared/academy_header" %>

<div class="yellow-title"><%= @camp.school_period.name.upcase %> - <%= @camp.name.upcase %></div>

<div class="container">
  <table class="table table-striped table-responsive table-center form-container" data-controller="clickable-table">
    <thead>
      <tr>
        <th>Activité</th>
        <th>Catégorie</th>
        <th>Lieu</th>
        <th>Coach</th>
        <th>Nombre d'élèves inscrits</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      <% @camp.activities.sort.each do |activity| %>
        <tr class="clickable-tr" data-clickable-table-target="clickable" data-url="<%= managers_activity_path(activity) %>">
          <td><%= activity.name %></td>
          <td><%= activity.category.name %></td>
          <td><%= activity.location.name %></td>
          <td><%= activity.coach.first_name %> <%= activity.coach.last_name %></td>
          <td><%= activity.students_count %></td>
          <td>
            <%= link_to managers_activity_path(activity), method: :delete, data: { turbo_method: :delete, turbo_confirm: "Êtes-vous sûr de vouloir supprimer cette activité ?" } do %>
              <i class="fas fa-trash trash"></i>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  <div class="flexy">
    <%= link_to "Ajouter une activité", new_managers_camp_activity_path(@camp), class: "btn btn-primary" %>
  </div>
</div>

<div class="yellow-title mt-2">ÉLÈVES INSCRITS</div>

<div class="container">
  <table class="table table-striped table-responsive table-center form-container">
    <thead>
      <tr>
        <th>Nom</th>
        <th>Prénom</th>
        <th>Age</th>
        <th>Activité 1</th>
        <th>Activité 2</th>
      </tr>
    </thead>
    <tbody>
      <% @camp.students_with_activity_enrollment.each do |student| %>
        <tr class="clickable-tr" onclick="window.location.href='<%= managers_student_path(student) %>'">
          <td><%= student.last_name %></td>
          <td><%= student.first_name %></td>
          <td><%= student.age %> ans</td>
          <td><%= student.student_activities(@camp).first.name %></td>
          <td><%= student.student_activities(@camp).second.name if student.student_activities(@camp).second%></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>
